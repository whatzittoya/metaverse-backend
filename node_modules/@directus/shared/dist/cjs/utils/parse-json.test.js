"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const vitest_1 = require("vitest");
const parse_json_1 = require("./parse-json");
(0, vitest_1.describe)('noproto', () => {
    (0, vitest_1.it)('Returns the value if the key is not __proto__', () => {
        let result = (0, parse_json_1.noproto)('anything', 'value');
        (0, vitest_1.expect)(result).toBe('value');
        result = (0, parse_json_1.noproto)('__proto__', 'malicious');
        (0, vitest_1.expect)(result).toBe(undefined);
    });
});
(0, vitest_1.describe)('parseJSON', () => {
    (0, vitest_1.it)('Parses JSON strings', () => {
        const result = (0, parse_json_1.parseJSON)(`{"name": "Directus"}`);
        (0, vitest_1.expect)(result).toEqual({ name: 'Directus' });
    });
    (0, vitest_1.it)('Ignores __proto__ properties', () => {
        const result = (0, parse_json_1.parseJSON)(`{"name": "Directus", "__proto__": "malicious" }`);
        (0, vitest_1.expect)(result).toEqual({ name: 'Directus' });
    });
});
